---
apiVersion: frrk8s.metallb.io/v1beta1
kind: FRRConfiguration
metadata:
  name: bgp-peers-ipv4-receive-all
  namespace: openshift-frr-k8s
  labels:
    routeAdvertisements: receive-all
spec:
  bgp:
    bfdProfiles:
      - name: bfd-default
        detectMultiplier: {{ .Values.bgpDetectMultiplier }}
        receiveInterval: {{ .Values.bgpReceiveInterval }}
        transmitInterval: {{ .Values.bgpTransmitInterval }}
    routers:
      - asn: {{ .Values.bgpASN }}
        {{- if .Values.bgpVRF }}
        vrf: {{ .Values.bgpVRF }}
        {{- end }}
        neighbors:
          {{- range $bgpNeighbor := .Values.bgpNeighbors }}
          - address: {{ $bgpNeighbor.bgpAddress }}
            asn: {{ $bgpNeighbor.bgpASN }}
            bfdProfile: bfd-default
            dualStackAddressFamily: false
            holdTime: {{ $.Values.bgpNeighborHoldTime }}
            keepaliveTime: {{ $.Values.bgpNeighborKeepaliveTime }}
            enableGracefulRestart: {{ $.Values.bgpNeighborEnableGracefulRestart }}
            disableMP: true
            toReceive:
              allowed:
                mode: all
          {{- end }}
